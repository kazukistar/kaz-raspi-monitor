<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, viewport-fit=cover" />
  <title>KAZ-RASPI / 監視モニタ</title>

  <!-- Fonts (free / Google Fonts) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">

  <style>
    :root{
      /* EVA-ish palette */
      --bg0:#04060a;
      --bg1:#060a10;
      --panel:#070b10;

      --text:#ffd38a;                /* warm amber */
      --muted:rgba(255, 211, 138, .68);

      --ok:#ffb343;                  /* amber */
      --caution:#ff5a2b;             /* orange-red */
      --warn:#ff1b1b;                /* red */

      --line:rgba(255, 180, 40, .60);
      --line2:rgba(255, 180, 40, .22);
      --glow:rgba(255, 170, 40, .14);

      --pad:14px;
      --gap:14px;
    }

    *{ box-sizing:border-box; }
    html,body{
      width:100%;
      height:100%;
      margin:0;
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(255,170,40,.10), transparent 62%),
        radial-gradient(1000px 600px at 80% 80%, rgba(255,27,27,.06), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      color:var(--text);
      overflow:hidden;
    }

    /* ===== Typography (NERV monitor vibe) =====
       - Labels: condensed
       - Numbers/Logs: mono
    */
    .font-label{ font-family:"Roboto Condensed", system-ui, sans-serif; }
    .font-mono { font-family:"Share Tech Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }

    /* ===== App frame (portrait + scroll OK) ===== */
    .frame{
      height:100%;
      width:100%;
      padding:
        calc(var(--pad) + env(safe-area-inset-top))
        calc(var(--pad) + env(safe-area-inset-right))
        calc(var(--pad) + env(safe-area-inset-bottom))
        calc(var(--pad) + env(safe-area-inset-left));
      display:flex;
      flex-direction:column;
      gap:var(--gap);
      overflow:auto; /* allow scroll on phone */
    }

    /* ===== Header ===== */
    .header{
      position:relative;
      border:1px solid var(--line2);
      background: linear-gradient(90deg, rgba(255,180,40,.12), rgba(255,180,40,.02));
      padding:10px 12px;
      display:grid;
      grid-template-columns: 1.3fr 1fr 1fr;
      gap:10px;
      align-items:center;
      box-shadow: 0 0 22px rgba(255,170,40,.10);
    }
    .header::before{
      content:"";
      position:absolute;
      inset:-2px;
      border:1px solid rgba(255,180,40,.14);
      pointer-events:none;
    }
    .hblock{ display:flex; flex-direction:column; gap:4px; }
    .hlabel{
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .hvalue{
      font-size:18px;
      letter-spacing:.10em;
      text-transform:uppercase;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .statusPill{
      justify-self:center;
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:6px 10px;
      border:1px solid rgba(255,180,40,.55);
      background: rgba(255,180,40,.06);
      box-shadow: 0 0 18px rgba(255,170,40,.10);
    }
    .dot{
      width:10px; height:10px; border-radius:50%;
      background:var(--ok);
      box-shadow: 0 0 14px rgba(255,170,40,.22);
    }

    /* ===== Sections ===== */
    .grid{
      display:flex;
      flex-direction:column;
      gap:var(--gap);
    }

    /* ===== Hex panel ===== */
    .hex{
      position:relative;
      background:
        linear-gradient(180deg, rgba(255,180,40,.10), rgba(255,180,40,.02));
      border:1px solid rgba(255,180,40,.60);
      clip-path: polygon(25% 3%, 75% 3%, 97% 50%, 75% 97%, 25% 97%, 3% 50%);
      padding:14px 16px;
      overflow:hidden; /* critical: no spill */
      filter: drop-shadow(0 0 10px rgba(255,170,40,.10));
      display:flex;
      flex-direction:column;
      justify-content:center;
      min-height: 170px;
    }
    .hex::before{
      content:"";
      position:absolute;
      inset:7px;
      border:1px solid rgba(255,180,40,.18);
      clip-path: polygon(25% 3%, 75% 3%, 97% 50%, 75% 97%, 25% 97%, 3% 50%);
      pointer-events:none;
    }
    .hex::after{
      content:"";
      position:absolute;
      top:-40%;
      left:-40%;
      width:90%;
      height:200%;
      transform:rotate(22deg);
      background: linear-gradient(90deg, transparent, rgba(255,180,40,.08), transparent);
      opacity:.35;
      pointer-events:none;
    }

    .hex.small{ min-height: 150px; }
    .hex.center{
      border-width:2px;
      padding:18px 20px;
      min-height: 230px;
    }

    .tag{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      font-size:12px;
      letter-spacing:.16em;
      color:var(--muted);
      text-transform:uppercase;
    }
    .mode{
      padding:2px 7px;
      border:1px solid rgba(255,180,40,.30);
      background: rgba(255,180,40,.05);
    }
    .title{
      margin-top:10px;
      font-size:14px;
      letter-spacing:.22em;
      text-transform:uppercase;
      color:rgba(255,211,138,.80);
    }

    /* Numbers: always fit */
    .big{
      margin-top:10px;
      font-size: clamp(34px, 10vw, 56px);
      letter-spacing:.06em;
      line-height:1.0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      text-shadow: 0 0 22px rgba(255,170,40,.14);
    }
    .hex.center .big{
      font-size: clamp(48px, 14vw, 74px);
    }
    .unit{
      font-size:.48em;
      opacity:.9;
      margin-left:6px;
    }

    .sub{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      font-size:13px;
      letter-spacing:.10em;
      color:var(--muted);
    }
    .sub b{ color:var(--text); font-weight:700; }

    /* ===== Two-column rows (phone portrait) ===== */
    .row2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:var(--gap);
    }
    @media (max-width: 420px){
      .row2{ grid-template-columns: 1fr; }
    }

    /* ===== Storage bars ===== */
    .barWrap{
      margin-top:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .bar{
      height:10px;
      border:1px solid rgba(255,180,40,.28);
      background: rgba(255,180,40,.05);
      position:relative;
      overflow:hidden;
    }
    .bar > i{
      position:absolute; inset:0;
      width:40%;
      background: linear-gradient(90deg, rgba(255,180,40,.78), rgba(255,180,40,.24));
      display:block;
    }
    .bar > i::after{
      content:"";
      position:absolute;
      top:0; right:-18px;
      width:18px; height:100%;
      background: rgba(255,180,40,.55);
      clip-path: polygon(0 0, 100% 0, 0 100%);
      opacity:.6;
    }

    .monoLine{
      margin-top:8px;
      font-size:13px;
      letter-spacing:.10em;
      white-space:pre;
      color:rgba(255,211,138,.85);
    }

    /* ===== Services log ===== */
    .svc{
      margin-top:12px;
      padding-top:10px;
      border-top:1px dashed rgba(255,180,40,.22);
      display:flex;
      flex-direction:column;
      gap:8px;
      font-size:13px;
      letter-spacing:.10em;
      color:rgba(255,211,138,.85);
    }
    .svcLine{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:10px;
      align-items:center;
    }
    .svcName{
      overflow:hidden;
      text-overflow:ellipsis;
      text-transform:uppercase;
    }
    .svcState{
      padding:2px 8px;
      border:1px solid rgba(255,180,40,.26);
      background: rgba(255,180,40,.05);
      text-transform:uppercase;
    }

    /* ===== Severity ===== */
    .sev-ok{ border-color: rgba(255,180,40,.60); }
    .sev-caution{
      border-color: rgba(255,90,43,.70);
      background: linear-gradient(180deg, rgba(255,90,43,.12), rgba(255,90,43,.02));
      filter: drop-shadow(0 0 14px rgba(255,90,43,.10));
    }
    .sev-warn{
      border-color: rgba(255,27,27,.86);
      background: linear-gradient(180deg, rgba(255,27,27,.16), rgba(255,27,27,.02));
      filter: drop-shadow(0 0 20px rgba(255,27,27,.14));
      animation: pulse 1.15s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform:translateZ(0); }
      50%{ filter: drop-shadow(0 0 30px rgba(255,27,27,.22)); }
    }

    /* ===== OFFLINE overlay ===== */
    .offlineOverlay{
      display:none;
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.80);
      backdrop-filter: blur(2px);
      z-index:50;
      align-items:center;
      justify-content:center;
      color:#ff2a2a;
      text-align:center;
      padding:24px;
    }
    .offlineOverlay .box{
      border:2px solid rgba(255,27,27,.86);
      padding:22px 22px;
      background: rgba(255,27,27,.08);
      box-shadow: 0 0 40px rgba(255,27,27,.16);
      letter-spacing:.20em;
      text-transform:uppercase;
      max-width: 560px;
      width:100%;
    }
    .offlineOverlay .box .jp{
      font-size:18px;
      margin-bottom:10px;
    }
    .offlineOverlay .box .en{
      font-size:44px;
      line-height:1;
    }
  </style>
</head>

<body>
  <div class="frame">

    <!-- Header -->
    <div class="header">
      <div class="hblock">
        <div class="hlabel font-label">監視対象 / TARGET</div>
        <div class="hvalue font-label" id="hostName">KAZ-RASPI</div>
      </div>

      <div class="statusPill">
        <span class="dot" id="onlineDot"></span>
        <span class="hvalue font-label" id="onlineText">稼働 / ONLINE</span>
      </div>

      <div class="hblock" style="justify-self:end; text-align:right;">
        <div class="hlabel font-label">更新 / UPDATE</div>
        <div class="hvalue font-mono"><span id="updateAge">1.0</span> s</div>
      </div>
    </div>

    <div class="grid">

      <!-- Center: TEMP -->
      <div class="hex center" id="tempHex">
        <div class="tag font-label">
          <span>温度 / TEMP</span>
          <span class="mode font-label">CPU</span>
        </div>
        <div class="title font-label">CPU 温度 / CPU TEMP</div>
        <div class="big font-mono"><span id="cpuTemp">58.2</span><span class="unit">℃</span></div>
        <div class="sub font-label">
          <span>判定 <b id="tempState">正常</b> / <span id="tempStateEn">NORMAL</span></span>
          <span>しきい値 <b>60</b> / <b>75</b> ℃</span>
        </div>
      </div>

      <!-- Row: CPU / RAM -->
      <div class="row2">
        <div class="hex small" id="cpuHex">
          <div class="tag font-label">
            <span>CPU 使用率</span>
            <span class="mode">UTIL</span>
          </div>
          <div class="title font-label">CPU / PROCESSOR</div>
          <div class="big font-mono"><span id="cpuUtil">41</span><span class="unit">%</span></div>
          <div class="sub font-label">
            <span>状態 <b id="cpuState">正常</b> / <span id="cpuStateEn">NORMAL</span></span>
          </div>
        </div>

        <div class="hex small" id="ramHex">
          <div class="tag font-label">
            <span>メモリ 使用率</span>
            <span class="mode">MEM</span>
          </div>
          <div class="title font-label">メモリ / MEMORY</div>
          <div class="big font-mono"><span id="ramUtil">63</span><span class="unit">%</span></div>
          <div class="sub font-label">
            <span>使用 <b id="ramUsed">2.6</b> / <span id="ramTotal">4.0</span> GB</span>
          </div>
        </div>
      </div>

      <!-- Row: LOAD / SERVICES -->
      <div class="row2">
        <div class="hex small" id="loadHex">
          <div class="tag font-label">
            <span>負荷 / LOAD</span>
            <span class="mode">AVG</span>
          </div>
          <div class="title font-label">ロードアベレージ / LOAD AVG</div>
          <div class="big font-mono"><span id="loadAvg">0.74</span></div>
          <div class="sub font-label">
            <span>稼働時間 <b id="uptime">12:34:56</b></span>
          </div>
        </div>

        <div class="hex small" id="svcHex">
          <div class="tag font-label">
            <span>サービス監視 / SERVICES</span>
            <span class="mode">UNIT</span>
          </div>
          <div class="title font-label">稼働状況 / SERVICE STATUS</div>

          <div class="svc font-mono">
            <div class="svcLine">
              <div class="svcName">GOJA-DENPO-SERVER</div>
              <div class="svcState" id="svcDenpo">稼働中...</div>
            </div>
            <div class="svcLine">
              <div class="svcName">GOJA-CLOUD-SERVER</div>
              <div class="svcState" id="svcCloud">稼働中...</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Row: SD / HDD -->
      <div class="row2">
        <div class="hex small" id="sdHex">
          <div class="tag font-label">
            <span>内部 記憶 / INTERNAL</span>
            <span class="mode">SD</span>
          </div>
          <div class="title font-label">SDカード / SD CARD</div>
          <div class="barWrap">
            <div class="bar"><i id="sdBar" style="width:31%"></i></div>
          </div>
          <div class="monoLine font-mono" id="sdText">USED 18.3 / 58.3 GB (31%)</div>
        </div>

        <div class="hex small" id="hddHex">
          <div class="tag font-label">
            <span>外部 記憶 / EXTERNAL</span>
            <span class="mode">HDD</span>
          </div>
          <div class="title font-label">外部HDD-01 / EXT HDD-01</div>
          <div class="barWrap">
            <div class="bar"><i id="hddBar" style="width:21%"></i></div>
          </div>
          <div class="monoLine font-mono" id="hddText">USED 212 / 1000 GB (21%)</div>
        </div>
      </div>

    </div>
  </div>

  <!-- OFFLINE overlay -->
  <div class="offlineOverlay" id="offline">
    <div class="box font-label">
      <div class="jp">通信断 / OFFLINE</div>
      <div class="en font-mono">NO SIGNAL</div>
    </div>
  </div>

  <script>
    // ===== Dummy data generator (UI-only phase) =====
    const el = (id) => document.getElementById(id);

    const tempHex = el("tempHex");
    const cpuHex  = el("cpuHex");
    const ramHex  = el("ramHex");
    const svcHex  = el("svcHex");

    const onlineDot = el("onlineDot");
    const onlineText = el("onlineText");
    const offline = el("offline");

    let lastTick = performance.now();
    let online = true;
    let uptimeSec = 0;

    function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }

    function setSeverity(node, sev){
      node.classList.remove("sev-ok","sev-caution","sev-warn");
      node.classList.add(sev === "warn" ? "sev-warn" : sev === "caution" ? "sev-caution" : "sev-ok");
    }

    function tempState(t){
      if(t >= 75) return {jp:"警戒", en:"EMERGENCY", sev:"warn"};
      if(t >= 60) return {jp:"注意", en:"CAUTION", sev:"caution"};
      return {jp:"正常", en:"NORMAL", sev:"ok"};
    }

    function percentState(p){
      if(p >= 90) return {jp:"警戒", en:"EMERGENCY", sev:"warn"};
      if(p >= 75) return {jp:"注意", en:"CAUTION", sev:"caution"};
      return {jp:"正常", en:"NORMAL", sev:"ok"};
    }

    function formatUptime(sec){
      sec = Math.max(0, Math.floor(sec));
      const h = String(Math.floor(sec/3600)).padStart(2,'0');
      const m = String(Math.floor((sec%3600)/60)).padStart(2,'0');
      const s = String(sec%60).padStart(2,'0');
      return `${h}:${m}:${s}`;
    }

    const services = {
      denpo: {state:"active", label:"稼働中..."},
      cloud: {state:"active", label:"稼働中..."},
    };

    function serviceLabel(st){
      if(st === "active") return "稼働中...";
      if(st === "restarting") return "再起動中...";
      return "停止";
    }

    function maybeFlipServices(){
      const r = Math.random();
      if(r < 0.03) services.denpo.state = "restarting";
      else if(r < 0.04) services.denpo.state = "inactive";
      else if(r < 0.07) services.denpo.state = "active";

      const c = Math.random();
      if(c < 0.02) services.cloud.state = "restarting";
      else if(c < 0.03) services.cloud.state = "inactive";
      else if(c < 0.06) services.cloud.state = "active";

      services.denpo.label = serviceLabel(services.denpo.state);
      services.cloud.label = serviceLabel(services.cloud.state);
    }

    function tick(){
      const now = performance.now();
      const dt = (now - lastTick) / 1000;
      lastTick = now;

      // simulate online/offline
      if(Math.random() < 0.006) online = !online;

      offline.style.display = online ? "none" : "flex";
      onlineDot.style.background = online ? "var(--ok)" : "var(--warn)";
      onlineText.textContent = online ? "稼働 / ONLINE" : "停止 / OFFLINE";
      el("updateAge").textContent = online ? "1.0" : "—";

      if(!online){
        requestAnimationFrame(tick);
        return;
      }

      uptimeSec += dt;
      el("uptime").textContent = formatUptime(uptimeSec);

      // CPU temp
      const t = clamp(55 + (Math.random()*18 - 9) + Math.sin(uptimeSec/7)*6, 42, 84);
      el("cpuTemp").textContent = t.toFixed(1);

      const ts = tempState(t);
      el("tempState").textContent = ts.jp;
      el("tempStateEn").textContent = ts.en;
      setSeverity(tempHex, ts.sev);

      // CPU util
      const cpu = clamp(35 + (Math.random()*40 - 20) + (t-55)*1.2, 2, 98);
      el("cpuUtil").textContent = Math.round(cpu);
      const cs = percentState(cpu);
      el("cpuState").textContent = cs.jp;
      el("cpuStateEn").textContent = cs.en;
      setSeverity(cpuHex, cs.sev);

      // RAM util
      const ram = clamp(55 + (Math.random()*30 - 15), 10, 95);
      el("ramUtil").textContent = Math.round(ram);
      el("ramTotal").textContent = "4.0";
      el("ramUsed").textContent = (4.0 * ram/100).toFixed(1);
      const rs = percentState(ram);
      setSeverity(ramHex, rs.sev);

      // Load
      const load = clamp((cpu/100)*2.2 + Math.random()*0.35, 0.05, 3.5);
      el("loadAvg").textContent = load.toFixed(2);

      // disks
      const sdP = clamp(22 + Math.random()*18, 5, 95);
      el("sdBar").style.width = `${sdP.toFixed(0)}%`;
      el("sdText").textContent = `USED ${(58.3*sdP/100).toFixed(1)} / 58.3 GB (${sdP.toFixed(0)}%)`;

      const hddP = clamp(18 + Math.random()*10, 2, 99);
      el("hddBar").style.width = `${hddP.toFixed(0)}%`;
      el("hddText").textContent = `USED ${(1000*hddP/100).toFixed(0)} / 1000 GB (${hddP.toFixed(0)}%)`;

      // services
      maybeFlipServices();
      el("svcDenpo").textContent = services.denpo.label;
      el("svcCloud").textContent = services.cloud.label;

      const anyDown = (services.denpo.state === "inactive") || (services.cloud.state === "inactive");
      const anyRestart = (services.denpo.state === "restarting") || (services.cloud.state === "restarting");
      if(anyDown) setSeverity(svcHex, "warn");
      else if(anyRestart) setSeverity(svcHex, "caution");
      else setSeverity(svcHex, "ok");

      requestAnimationFrame(tick);
    }

    // init
    setSeverity(tempHex, "ok");
    setSeverity(cpuHex, "ok");
    setSeverity(ramHex, "ok");
    setSeverity(svcHex, "ok");
    requestAnimationFrame(tick);
  </script>
</body>
</html>
