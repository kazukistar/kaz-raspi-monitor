<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>KAZ-RASPI | SERVER STATUS MONITOR</title>

  <!-- 7-seg font (DSEG7) -->
  <style>
    /* DSEG7 (CDN). GitHub Pagesでそのまま読める */
    @font-face{
      font-family:"DSEG7";
      src:url("https://cdn.jsdelivr.net/gh/keshikan/DSEG@master/fonts/DSEG7Classic-Bold.woff2") format("woff2");
      font-weight:700;
      font-style:normal;
      font-display:swap;
    }
  </style>

  <style>
    :root{
      --bg:#050607;
      --gold:#f6c200;          /* エヴァ寄り黄色 */
      --gold2:#c89200;
      --ink:#0b0c0d;
      --text:rgba(246,194,0,.92);
      --textDim:rgba(246,194,0,.70);
      --panel:rgba(7,8,9,.70);
      --glow:rgba(246,194,0,.22);

      --cardW:min(86vw, 520px); /* スマホ縦でのカード最大幅 */
      --hexH: calc(var(--cardW) * 0.78); /* 六角形の高さ（見た目最優先） */
      --padTop: clamp(14px, 3.2vw, 22px);
      --padMid: clamp(10px, 2.6vw, 18px);
      --padBot: clamp(12px, 3.2vw, 22px);
    }

    html, body { height:100%; }
    body{
      margin:0;
      background: radial-gradient(1200px 800px at 50% -100px, rgba(246,194,0,.10), transparent 60%),
                  radial-gradient(900px 900px at 50% 40%, rgba(246,194,0,.06), transparent 62%),
                  linear-gradient(180deg, #070809 0%, #040405 60%, #020203 100%);
      color:var(--text);
      font-family: "Times New Roman", Times, serif;
      overflow-x:hidden;
    }

    /* うっすらNERVっぽい粒子 */
    body:before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(circle at 20% 30%, rgba(246,194,0,.06), transparent 35%),
        radial-gradient(circle at 80% 60%, rgba(246,194,0,.05), transparent 40%),
        radial-gradient(circle at 50% 90%, rgba(246,194,0,.04), transparent 45%);
      mix-blend-mode:screen;
      filter: blur(0.5px);
      opacity:.9;
    }

    .wrap{
      min-height:100%;
      padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
    }

    /* ===== Header ===== */
    .header{
      width:min(92vw, 620px);
      margin: 18px auto 18px;
      padding: 18px 18px 16px;
      border: 1px solid rgba(246,194,0,.35);
      box-shadow: 0 0 22px rgba(246,194,0,.10), inset 0 0 18px rgba(246,194,0,.06);
      background: linear-gradient(180deg, rgba(8,9,10,.72), rgba(5,6,7,.56));
      position:relative;
    }
    .header:before{
      content:"";
      position:absolute;
      inset:-2px;
      border:1px solid rgba(246,194,0,.18);
      pointer-events:none;
    }

    .headRow{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .title{
      font-weight:700;
      letter-spacing:.14em;
      font-size: clamp(22px, 5.2vw, 34px);
      line-height:1;
      text-transform:uppercase;
    }
    .subtitle{
      margin-top:6px;
      color:rgba(246,194,0,.68);
      letter-spacing:.22em;
      font-size: clamp(11px, 2.8vw, 13px);
      font-weight:700;
    }

    .statusBox{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border:1px solid rgba(246,194,0,.35);
      background: rgba(6,7,8,.50);
      box-shadow: inset 0 0 12px rgba(246,194,0,.08);
      font-weight:700;
      letter-spacing:.10em;
      text-transform:uppercase;
      font-size: clamp(11px, 2.8vw, 13px);
      white-space:nowrap;
    }
    .dot{
      width:10px; height:10px;
      border-radius:50%;
      background: var(--gold);
      box-shadow: 0 0 14px rgba(246,194,0,.50);
      flex:0 0 auto;
    }

    .metaRow{
      margin-top:10px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      color:rgba(246,194,0,.62);
      letter-spacing:.20em;
      text-transform:uppercase;
      font-weight:700;
      font-size: clamp(10px, 2.6vw, 12px);
    }

    /* ===== Cards list ===== */
    .cards{
      width:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 22px;
      padding: 8px 0 40px;
    }

    /* ===== Hex Card ===== */
    .hex{
      width: var(--cardW);
      height: var(--hexH);
      position:relative;
      filter: drop-shadow(0 0 12px rgba(246,194,0,.12));
    }

    /* 六角形（見た目と枠線） */
    .hex .plate{
      position:absolute;
      inset:0;
      clip-path: polygon(50% 0%,
                         93% 25%,
                         93% 75%,
                         50% 100%,
                         7% 75%,
                         7% 25%);
      background: radial-gradient(120% 120% at 50% 20%, rgba(246,194,0,.14), rgba(0,0,0,.0) 55%),
                  linear-gradient(180deg, rgba(10,11,12,.80), rgba(4,5,6,.62));
      border: 3px solid rgba(246,194,0,.78);
      box-shadow:
        inset 0 0 0 2px rgba(10,11,12,.85),
        inset 0 0 0 6px rgba(246,194,0,.18),
        0 0 24px rgba(246,194,0,.08);
    }

    /* 内側の細枠 */
    .hex .plate:before{
      content:"";
      position:absolute;
      inset: 10px;
      clip-path: inherit;
      border: 2px solid rgba(246,194,0,.42);
      opacity:.9;
    }

    /* 内容は六角形内に収める（safe padding + overflow hidden） */
    .hex .content{
      position:absolute;
      inset: 0;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      text-align:center;
      padding: var(--padTop) 34px var(--padBot);
      overflow:hidden; /* はみ出し絶対禁止 */
      box-sizing:border-box;
    }

    /* 見出し（日本語：HPG明朝E 太字想定） */
    .kTitle{
      font-family: "HPG明朝E", "Hiragino Mincho ProN", "Yu Mincho", "MS Mincho", serif;
      font-weight: 800;
      color: var(--text);
      letter-spacing: .06em;
      font-size: clamp(22px, 6.2vw, 34px); /* もっとデカく */
      line-height:1.05;
      margin-top: 2px;
      margin-bottom: 10px;
      max-width: 100%;
      white-space: nowrap; /* 1行で決める */
      overflow:hidden;
      text-overflow: ellipsis;
    }

    /* サブタイトル（2行用：通信速度など） */
    .kTitle2{
      font-family: "HPG明朝E", "Hiragino Mincho ProN", "Yu Mincho", "MS Mincho", serif;
      font-weight: 800;
      color: var(--text);
      letter-spacing: .06em;
      font-size: clamp(20px, 5.6vw, 32px);
      line-height:1.05;
      margin: 0 0 8px;
      max-width:100%;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .kSubLine{
      margin-top: -2px;
      font-family: "Times New Roman", Times, serif;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: .18em;
      color: rgba(246,194,0,.78);
      font-size: clamp(12px, 3.4vw, 16px);
      max-width:100%;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* メイン値（7セグ） */
    .valueRow{
      margin-top: 6px;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      gap: 10px;
      flex-wrap:nowrap;
      max-width: 100%;
    }
    .value{
      font-family:"DSEG7", monospace;
      font-weight:700;
      font-size: clamp(62px, 16vw, 96px); /* 58/50/63 をもっと大きく */
      letter-spacing: .04em;
      line-height: .92;
      color: var(--gold);
      text-shadow: 0 0 18px rgba(246,194,0,.16);
    }
    .unit{
      font-family: "Times New Roman", Times, serif;
      font-weight:700;
      font-size: clamp(18px, 5.2vw, 26px);
      letter-spacing: .06em;
      color: rgba(246,194,0,.80);
      transform: translateY(-10px);
      white-space:nowrap;
    }

    /* 仕切り線（点線） */
    .divider{
      width: 92%;
      margin: 12px auto 10px;
      border-top: 4px dashed rgba(246,194,0,.55);
      opacity:.9;
    }

    /* 下段ステータス（日本語） */
    .footer{
      margin-top: 0;
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      flex-wrap:wrap;
      font-family: "HPG明朝E", "Hiragino Mincho ProN", "Yu Mincho", "MS Mincho", serif;
      font-weight: 800;
      letter-spacing:.10em;
      color: rgba(246,194,0,.86);
      font-size: clamp(18px, 4.8vw, 24px);
      white-space:nowrap;
    }

    /* ===== Storage style ===== */
    .barWrap{
      width:min(92%, 520px);
      margin-top: 6px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .barLabel{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
      font-family:"Times New Roman", Times, serif;
      font-weight:700;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: rgba(246,194,0,.80);
      font-size: clamp(12px, 3.2vw, 14px);
      white-space:nowrap;
    }
    .bar{
      height: 12px;
      border: 1px solid rgba(246,194,0,.45);
      background: rgba(0,0,0,.25);
      box-shadow: inset 0 0 12px rgba(246,194,0,.08);
      position:relative;
      overflow:hidden;
    }
    .bar > i{
      display:block;
      height:100%;
      width:30%;
      background: linear-gradient(90deg, rgba(246,194,0,.15), rgba(246,194,0,.70), rgba(246,194,0,.25));
      filter: saturate(1.2);
      box-shadow: 0 0 18px rgba(246,194,0,.18);
    }

    /* ===== Server list ===== */
    .srvList{
      width: min(92%, 520px);
      margin-top: 10px;
      display:flex;
      flex-direction:column;
      gap: 12px;
    }
    .srvRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 12px;
      border:1px solid rgba(246,194,0,.28);
      background: rgba(4,5,6,.35);
      box-shadow: inset 0 0 14px rgba(246,194,0,.06);
    }
    .srvName{
      display:flex;
      flex-direction:column;
      gap:2px;
      text-align:left;
      min-width: 0;
    }
    .srvName .l1{
      font-family:"Times New Roman", Times, serif;
      font-weight:700;
      letter-spacing:.20em;
      text-transform:uppercase;
      color: rgba(246,194,0,.78);
      font-size: clamp(12px, 3.2vw, 14px);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .srvName .l2{
      font-family:"Times New Roman", Times, serif;
      font-weight:700;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(246,194,0,.92);
      font-size: clamp(13px, 3.6vw, 16px);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .pill{
      flex:0 0 auto;
      padding: 8px 10px;
      border:1px solid rgba(246,194,0,.40);
      background: rgba(0,0,0,.25);
      font-family:"HPG明朝E","Yu Mincho","MS Mincho",serif;
      font-weight:800;
      letter-spacing:.10em;
      color: rgba(246,194,0,.88);
      font-size: clamp(13px, 3.4vw, 15px);
      white-space:nowrap;
    }

    /* 余白をスマホで気持ちよく */
    .spacer{ height: 8px; }

    /* 横画面でも崩れない */
    @media (orientation: landscape){
      :root{
        --cardW: min(70vw, 520px);
      }
      .header{ width:min(82vw, 680px); }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header class="header">
      <div class="headRow">
        <div>
          <div class="title">KAZ-RASPI</div>
          <div class="subtitle">SERVER STATUS MONITOR</div>
        </div>
        <div class="statusBox">
          <span class="dot" id="sysDot"></span>
          <span id="sysText">SYSTEM / ONLINE</span>
        </div>
      </div>
      <div class="metaRow">
        <div id="smallLeft">KAZ-RASPI / MONITOR</div>
        <div id="smallRight">UPDATE: <span id="upd">1.0</span> S</div>
      </div>
    </header>

    <main class="cards" id="cards">
      <!-- CPU TEMP -->
      <section class="hex" aria-label="CPU温度">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle">CPU温度</div>
          <div class="valueRow">
            <div class="value" id="cpuTemp">58</div>
            <div class="unit">℃</div>
          </div>
          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="cpuTempState">通常</span></div>
        </div>
      </section>

      <!-- CPU UTIL -->
      <section class="hex" aria-label="CPU稼働率">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle">CPU稼働率</div>
          <div class="valueRow">
            <div class="value" id="cpuUtil">50</div>
            <div class="unit">%</div>
          </div>
          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="cpuUtilState">通常</span></div>
        </div>
      </section>

      <!-- MEM UTIL -->
      <section class="hex" aria-label="メモリ稼働率">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle">メモリ稼働率</div>
          <div class="valueRow">
            <div class="value" id="memUtil">63</div>
            <div class="unit">%</div>
          </div>
          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="memUtilState">通常</span></div>
        </div>
      </section>

      <!-- NET DOWNLOAD -->
      <section class="hex" aria-label="通信速度 DOWNLOAD">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle2">通信速度</div>
          <div class="kSubLine">《DOWNLOAD》</div>
          <div class="valueRow" style="margin-top:10px;">
            <div class="value" id="netDown">121</div>
            <div class="unit">Mbps</div>
          </div>
          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="netDownState">通常</span></div>
        </div>
      </section>

      <!-- NET UPLOAD -->
      <section class="hex" aria-label="通信速度 UPLOAD">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle2">通信速度</div>
          <div class="kSubLine">《UPLOAD》</div>
          <div class="valueRow" style="margin-top:10px;">
            <div class="value" id="netUp">35</div>
            <div class="unit">Mbps</div>
          </div>
          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="netUpState">通常</span></div>
        </div>
      </section>

      <!-- STORAGE SD -->
      <section class="hex" aria-label="SDカード 記憶容量">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle">記憶容量</div>

          <div class="barWrap">
            <div class="barLabel">
              <span>SDカード</span>
              <span id="sdText">USED 18.1 / 58.3 GB (31%)</span>
            </div>
            <div class="bar"><i id="sdBar" style="width:31%"></i></div>
          </div>

          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="sdState">通常</span></div>
        </div>
      </section>

      <!-- STORAGE HDD -->
      <section class="hex" aria-label="外付けHDD 記憶容量">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle">記憶容量</div>

          <div class="barWrap">
            <div class="barLabel">
              <span>外付けHDD</span>
              <span id="hddText">USED 210 / 1000 GB (21%)</span>
            </div>
            <div class="bar"><i id="hddBar" style="width:21%"></i></div>
          </div>

          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="hddState">通常</span></div>
        </div>
      </section>

      <!-- SERVICES -->
      <section class="hex" aria-label="サーバー稼働状況">
        <div class="plate"></div>
        <div class="content">
          <div class="kTitle">サーバー稼働状況</div>

          <div class="srvList" style="margin-top:6px;">
            <div class="srvRow">
              <div class="srvName">
                <div class="l1">GOJA</div>
                <div class="l2">DENPO-SERVER</div>
              </div>
              <div class="pill" id="svcDenpo">稼働中…</div>
            </div>

            <div class="srvRow">
              <div class="srvName">
                <div class="l1">GOJA</div>
                <div class="l2">CLOUD-SERVER</div>
              </div>
              <div class="pill" id="svcCloud">稼働中…</div>
            </div>
          </div>

          <div class="divider"></div>
          <div class="footer"><span>稼働状態：</span><span id="svcState">通常</span></div>
        </div>
      </section>

      <div class="spacer"></div>
    </main>
  </div>

  <script>
    /* ====== ここは「UI確認用のダミー値」 ======
       実機APIに繋ぐ時は、この state を fetch の結果で更新するだけでOK */

    const clamp = (v, a, b) => Math.max(a, Math.min(b, v));

    // ゆっくり動くように：指数移動平均(EMA)
    function ema(prev, target, alpha){
      return prev + (target - prev) * alpha;
    }

    // 状態と閾値（必要に応じて調整）
    const TH = {
      temp: { caution: 70, warn: 80 },
      util: { caution: 85, warn: 95 },
      mem:  { caution: 85, warn: 95 },
      net:  { caution: 10, warn: 3 }, // Mbps低すぎ注意（例）
      sd:   { caution: 85, warn: 95 },
      hdd:  { caution: 85, warn: 95 }
    };

    const el = {
      cpuTemp: document.getElementById("cpuTemp"),
      cpuUtil: document.getElementById("cpuUtil"),
      memUtil: document.getElementById("memUtil"),
      netDown: document.getElementById("netDown"),
      netUp: document.getElementById("netUp"),

      cpuTempState: document.getElementById("cpuTempState"),
      cpuUtilState: document.getElementById("cpuUtilState"),
      memUtilState: document.getElementById("memUtilState"),
      netDownState: document.getElementById("netDownState"),
      netUpState: document.getElementById("netUpState"),
      sdState: document.getElementById("sdState"),
      hddState: document.getElementById("hddState"),
      svcState: document.getElementById("svcState"),

      sdText: document.getElementById("sdText"),
      hddText: document.getElementById("hddText"),
      sdBar: document.getElementById("sdBar"),
      hddBar: document.getElementById("hddBar"),

      svcDenpo: document.getElementById("svcDenpo"),
      svcCloud: document.getElementById("svcCloud"),

      sysDot: document.getElementById("sysDot"),
      sysText: document.getElementById("sysText"),
      upd: document.getElementById("upd")
    };

    // ダミー初期値（今の画面に近い）
    const state = {
      cpuTemp: 58,
      cpuUtil: 50,
      memUtil: 63,
      netDown: 121,
      netUp: 35,
      sdUsed: 18.1, sdTotal: 58.3,
      hddUsed: 210, hddTotal: 1000,
      denpo: true,
      cloud: true
    };

    // 目標値（ふわっと変える）
    const target = {
      cpuTemp: 62,
      cpuUtil: 46,
      memUtil: 61,
      netDown: 95,
      netUp: 28,
      sdUsed: 18.2,
      hddUsed: 212
    };

    function gradeLabel(val, th){
      // valが高いほど危険（温度・%系）
      if(val >= th.warn) return "警戒";
      if(val >= th.caution) return "注意";
      return "通常";
    }

    function gradeNet(val){
      // ネットは低いほど危険（例）
      if(val <= TH.net.warn) return "警戒";
      if(val <= TH.net.caution) return "注意";
      return "通常";
    }

    function setSysOnline(isOnline){
      el.sysText.textContent = isOnline ? "SYSTEM / ONLINE" : "SYSTEM / OFFLINE";
      el.sysDot.style.opacity = isOnline ? "1" : ".35";
      el.sysDot.style.filter = isOnline ? "none" : "grayscale(1)";
    }

    // 値を “速すぎず” 動かす：目標値をたまに変えて、EMAで追従
    function tick(){
      // たまに目標値を変える（1秒ごとに大きく揺れない）
      if(Math.random() < 0.18){
        target.cpuTemp = clamp(target.cpuTemp + (Math.random()*6 - 3), 45, 85);
        target.cpuUtil = clamp(target.cpuUtil + (Math.random()*10 - 5), 5, 98);
        target.memUtil = clamp(target.memUtil + (Math.random()*6 - 3), 10, 95);
        target.netDown = clamp(target.netDown + (Math.random()*40 - 20), 1, 999);
        target.netUp   = clamp(target.netUp   + (Math.random()*20 - 10), 1, 999);

        target.sdUsed  = clamp(target.sdUsed + (Math.random()*0.20 - 0.05), 0, state.sdTotal);
        target.hddUsed = clamp(target.hddUsed + (Math.random()*2.0 - 0.5), 0, state.hddTotal);
      }

      // EMA（alpha小さめ＝ゆっくり）
      state.cpuTemp = ema(state.cpuTemp, target.cpuTemp, 0.10);
      state.cpuUtil = ema(state.cpuUtil, target.cpuUtil, 0.12);
      state.memUtil = ema(state.memUtil, target.memUtil, 0.10);
      state.netDown = ema(state.netDown, target.netDown, 0.10);
      state.netUp   = ema(state.netUp, target.netUp, 0.10);
      state.sdUsed  = ema(state.sdUsed, target.sdUsed, 0.08);
      state.hddUsed = ema(state.hddUsed, target.hddUsed, 0.06);

      // 表示（整数中心）
      const cpuTempI = Math.round(state.cpuTemp);
      const cpuUtilI = Math.round(state.cpuUtil);
      const memUtilI = Math.round(state.memUtil);
      const netDownI = Math.round(state.netDown);
      const netUpI   = Math.round(state.netUp);

      el.cpuTemp.textContent = cpuTempI;
      el.cpuUtil.textContent = cpuUtilI;
      el.memUtil.textContent = memUtilI;
      el.netDown.textContent = netDownI;
      el.netUp.textContent   = netUpI;

      el.cpuTempState.textContent = gradeLabel(cpuTempI, TH.temp);
      el.cpuUtilState.textContent = gradeLabel(cpuUtilI, TH.util);
      el.memUtilState.textContent = gradeLabel(memUtilI, TH.mem);
      el.netDownState.textContent = gradeNet(netDownI);
      el.netUpState.textContent   = gradeNet(netUpI);

      // Storage
      const sdPct  = Math.round((state.sdUsed / state.sdTotal) * 100);
      const hddPct = Math.round((state.hddUsed / state.hddTotal) * 100);

      el.sdText.textContent  = `USED ${state.sdUsed.toFixed(1)} / ${state.sdTotal.toFixed(1)} GB (${sdPct}%)`;
      el.hddText.textContent = `USED ${Math.round(state.hddUsed)} / ${Math.round(state.hddTotal)} GB (${hddPct}%)`;

      el.sdBar.style.width  = `${clamp(sdPct, 0, 100)}%`;
      el.hddBar.style.width = `${clamp(hddPct, 0, 100)}%`;

      el.sdState.textContent  = gradeLabel(sdPct, TH.sd);
      el.hddState.textContent = gradeLabel(hddPct, TH.hdd);

      // Services（今は常時稼働中ダミー）
      el.svcDenpo.textContent = state.denpo ? "稼働中…" : "停止";
      el.svcCloud.textContent = state.cloud ? "稼働中…" : "停止";
      el.svcState.textContent = (state.denpo && state.cloud) ? "通常" : "注意";

      setSysOnline(true);
    }

    // 更新間隔（表示は1秒）ただし値はEMAで滑らか
    const UPDATE_SEC = 1.0;
    el.upd.textContent = UPDATE_SEC.toFixed(1);

    tick();
    setInterval(tick, UPDATE_SEC * 1000);
  </script>
</body>
</html>